package org.uaa.reader;import org.apache.poi.ss.usermodel.Row;import org.apache.poi.ss.usermodel.Sheet;import org.apache.poi.ss.usermodel.Workbook;import org.apache.poi.xssf.usermodel.XSSFWorkbook;import java.io.File;import java.io.FileInputStream;import java.text.SimpleDateFormat;import java.util.ArrayList;import java.util.Arrays;import java.util.List;public class ExcelReader{    public List<LabelDto> readFile(String path)    {        FileInputStream file = null;        List<LabelDto> labels = new ArrayList<>();        String pattern = "MM.yyyy";        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(pattern);        try        {            file = new FileInputStream(new File(path));            Workbook workbook = new XSSFWorkbook(file);            Sheet sheet = workbook.getSheetAt(0);            for (Row row : sheet)            {                if (row.getRowNum() == 0)                {                    System.out.println(                            row.getCell(0) + "\t" +                            row.getCell(1) + "\t" +                            row.getCell(2) + "\t" +                            row.getCell(3) + "\t" +                            row.getCell(4) + "\t" +                            row.getCell(5) + "\t" +                            row.getCell(6) + "\t" +                            row.getCell(7) + "\t"                    );                }                else                {                    String sizes = row.getCell(1).getStringCellValue();                    for (String currentSize : Arrays.stream(sizes.split(";")).toList())                    {                        LabelDto labelDto = new LabelDto();                        labelDto.setModel(row.getCell(0).getStringCellValue());                        labelDto.setRazmer(currentSize);                        Double poln = row.getCell(2).getNumericCellValue();                        labelDto.setPolnota(String.valueOf(poln.intValue()));                        String date = simpleDateFormat.format(row.getCell(3).getDateCellValue());                        labelDto.setDataVypuska(date);                        labelDto.setMaterVerh(row.getCell(4).getStringCellValue());                        labelDto.setMaterPodkladka(row.getCell(5).getStringCellValue());                        labelDto.setMaterNiz(row.getCell(6).getStringCellValue());                        labels.add(labelDto);                    }                }                System.out.println("Row number " + row.getRowNum() + " complete");            }            for (LabelDto label : labels)            {                System.out.println(label);            }        }        catch (Exception e)        {            throw new RuntimeException(e);        }        return labels;    }}